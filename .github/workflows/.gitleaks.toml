title = "Full Repository Secret Scan"

[extend]
useDefault = true    # 启用内置规则

[scan]
git = false          # 扫描整个工作区而不是 diff/commit
depth = 0            # 扫描所有历史（如果 git=true 时有效）

[allowlist]
files = ["test/.*", "mock_data/.*"]   # 忽略的路径
regexes = ["example_key", "dummy_password"]

# ======== 自定义规则 ========

[[rules]]
id = "mysql-password"
description = "Hardcoded MySQL password"
regex = '''(?i)(password|pwd|pass|passwd)\s*=\s*['"][A-Za-z0-9!@#$%^&*()_+=-]{6,}['"]'''
tags = ["password", "mysql"]

[[rules]]
id = "api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|secret|token)\s*[:=]\s*['"]?[A-Za-z0-9_\-]{16,}['"]?'''
tags = ["api", "key"]
